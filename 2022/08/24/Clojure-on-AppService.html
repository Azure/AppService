<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.5 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Clojure on App Service - Azure App Service</title>
<meta name="description" content="Build and run a Web App written in Clojure, on Azure App Service">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Azure App Service">
<meta property="og:title" content="Clojure on App Service">
<meta property="og:url" content="https://azure.github.io/AppService/2022/08/24/Clojure-on-AppService.html">


  <meta property="og:description" content="Build and run a Web App written in Clojure, on Azure App Service">



  <meta property="og:image" content="https://azure.github.io/AppService/assets/images/icon.png">





  <meta property="article:published_time" content="2022-08-24T00:00:00+00:00">





  

  


<link rel="canonical" href="https://azure.github.io/AppService/2022/08/24/Clojure-on-AppService.html">





  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "url": "https://azure.github.io/AppService",
      "logo": "https://azure.github.io/AppService/assets/images/icon.png"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Azure App Service",
      "url": "https://azure.github.io/AppService",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/AppService/feed.xml" type="application/atom+xml" rel="alternate" title="Azure App Service Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/AppService/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->

<!-- Jekyll env: production -->



    <!-- insert favicons. use https://realfavicongenerator.net/ -->
<link rel="icon" 
      type="image/png" 
      href="/AppService/media/pages/new_app_service_logo_16.png">
<link rel="shortcut icon" 
      type="image/png" 
      href="/AppService/media/pages/new_app_service_logo_16.png">

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/AppService/"><img src="/AppService/media/pages/new_app_service_logo_64.svg" alt=""></a>
        
        <a class="site-title" href="/AppService/">
          Azure App Service
          <span class="site-subtitle">Team Blog</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/AppService/tags/" >Tags</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          
          

          <a href="/AppService/"><span class="nav__sub-title">Home</span></a>
        

        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Product Areas</span>
        

        
        <ul>
          
            
            

            
            

            <li>
              <a href="/AppService/networking/" class="">Networking & ASE</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/java/" class="">Java</a>
              
                
                
                
                
    
                
                
                <ul>
                  <li style="padding-left: 6px;"><a href="/AppService/java/videos/" class="">Videos</a></li>
                </ul>
                
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/diagnostics/" class="">Diagnostics</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/certsdomains/" class="">Certs and Domains</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/deployment/" class="">Deployment, CI/CD, Slots</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/windows-containers/" class="">Windows Containers</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/sidecars/" class="">Sidecars</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/ai-integration/" class="">AI Integration</a>
              
            </li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Reference</span>
        

        
        <ul>
          
            
            

            
            

            <li>
              <a href="https://docs.microsoft.com/azure/app-service/" class="">Documentation</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="https://github.com/Azure/app-service-linux-docs" class="">Linux FAQ</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="https://aka.ms/appservicewindowscontainerwiki" class="">Windows Containers Wiki</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/zero-to-hero/" class="">Zero to Hero tutorials</a>
              
            </li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">More</span>
        

        
        <ul>
          
            
            

            
            

            <li>
              <a href="https://twitter.com/Azure" class="">Twitter</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/feed.xml" class="">RSS Feed</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="https://azure.microsoft.com/blog/" class="">Azure Blog</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="https://azure.microsoft.com/updates/" class="">Azure Updates</a>
              
            </li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Archives</span>
        

        
        <ul>
          
            
            

            
            

            <li>
              <a href="/AppService/2020" class="">2020</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/2019" class="">2019</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/2018" class="">2018</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/2017" class="">2017</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/2016" class="">2016</a>
              
            </li>
          
            
            

            
            

            <li>
              <a href="/AppService/posts/" class="">All posts</a>
              
            </li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>
    
  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Clojure on App Service">
    <meta itemprop="description" content="Build and run a Web App written in Clojure, on Azure App Service">
    <meta itemprop="datePublished" content="August 24, 2022">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Clojure on App Service
</h1>
          <p class="page__meta">
            
              <i class="far fa-clock" aria-hidden="true"></i> 




  7 minute read

            
            
              • By Denis Fuenzalida
            
            • August 24, 2022
          </p>
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#the-guestbook-application">The guestbook application</a></li>
  <li><a href="#prerequisites">Prerequisites</a>
    <ul>
      <li><a href="#optional-packages-for-local-development">Optional packages for local development</a></li>
      <li><a href="#differences-with-the-original-guestbook-application">Differences with the original guestbook application</a></li>
    </ul>
  </li>
  <li><a href="#clone-the-repo">Clone the repo</a></li>
  <li><a href="#build-and-run-the-application-locally">Build and run the application locally</a>
    <ul>
      <li><a href="#run-a-postgresql-database-for-development">Run a PostgreSQL database for development</a></li>
      <li><a href="#launching-the-application">Launching the application</a></li>
    </ul>
  </li>
  <li><a href="#deployment-on-azure">Deployment on Azure</a>
    <ul>
      <li><a href="#creating-cloud-resources">Creating cloud resources</a></li>
      <li><a href="#configure-the-deployment">Configure the deployment</a></li>
      <li><a href="#update-the-pom-file">Update the POM file</a></li>
    </ul>
  </li>
</ul>
            </nav>
          </aside>
        
        <p>Clojure is a dynamic, general-purpose programming language from the Lisp family that runs on the Java Virtual Machine. You can build web apps in Clojure and deploy them to Azure App Service as a JAR file.</p>

<p>This article uses an example web app written in <a href="https://clojure.org/">Clojure</a> based on the guestbook app from the <a href="https://luminusweb.com/">Luminus framework</a>, updated to use PostgreSQL and ready to deploy to Azure App Service in a few simple steps.</p>

<h2 id="the-guestbook-application">The <code class="language-plaintext highlighter-rouge">guestbook</code> application</h2>

<p>The <a href="https://github.com/Azure-Samples/clojure-on-app-service">example application</a> is a simple guestbook app where visitors can write messages about a site they visited. The data is stored and read from a PostgreSQL database on Azure which is created by a helper script.</p>

<p><img src="/AppService/media/2022/08/guestbook-screenshot.png" alt="Screenshot of the guestbook web app showing a form to enter the visitor's name and message" /></p>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
  <li>Java 8 or Java 11 (Java 11 is used as the default in this project)</li>
  <li><a href="https://leiningen.org/">Leinigen</a></li>
  <li>An Azure subscription (<a href="https://azure.microsoft.com/en-us/free/">free trial</a>)</li>
  <li><a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli">Azure CLI</a></li>
  <li><a href="https://maven.apache.org/">Apache Maven</a></li>
</ul>

<h3 id="optional-packages-for-local-development">Optional packages for local development</h3>

<ul>
  <li><a href="https://code.visualstudio.com/">Visual Studio Code</a> with the <a href="https://marketplace.visualstudio.com/items?itemName=betterthantomorrow.calva">Calva</a> extension for Clojure</li>
  <li>Docker, used to run PostgreSQL locally in a Docker container</li>
  <li>GNU sed, used for text replacement on the command line before deploying (you can edit the file in a text/code editor though). Note that <code class="language-plaintext highlighter-rouge">sed</code> comes pre-installed by default in most Linux distributions, and also in Git for Windows</li>
</ul>

<h3 id="differences-with-the-original-guestbook-application">Differences with the original <code class="language-plaintext highlighter-rouge">guestbook</code> application</h3>

<p>The following changes have been made from the <a href="https://github.com/luminus-framework/examples/tree/master/guestbook">original guestbook app</a>:</p>

<ul>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">start-app</code> function from <code class="language-plaintext highlighter-rouge">core.clj</code> file has been updated to run the database migrations on the application startup, as explained in the <a href="https://luminusweb.com/docs/deployment.html#heroku_deployment">deployment documentation</a>.</p>
  </li>
  <li>
    <p>The migration file has been renamed to reflect that the file creates the <code class="language-plaintext highlighter-rouge">guestbook</code> table, instead of an <code class="language-plaintext highlighter-rouge">users</code> table.</p>
  </li>
  <li>
    <p>The table definition (DDL) uses the PostgreSQL syntax instead of the original (H2). There are some minor differences on the definition of primary keys and timestamps, but this is expected.</p>
  </li>
</ul>

<h2 id="clone-the-repo">Clone the repo</h2>

<ul>
  <li>
    <p>Clone the Clojure on App Service repository with: <code class="language-plaintext highlighter-rouge">git clone https://github.com/Azure-Samples/clojure-on-app-service.git</code></p>
  </li>
  <li>
    <p>Change directory with: <code class="language-plaintext highlighter-rouge">cd clojure-on-app-service</code></p>
  </li>
</ul>

<h2 id="build-and-run-the-application-locally">Build and run the application locally</h2>

<p>If you want to test this application locally before deploying to App Service, follow the steps on this section, otherwise you can skip to the <a href="#deployment-on-azure">Deployment on Azure</a> section.</p>

<h3 id="run-a-postgresql-database-for-development">Run a PostgreSQL database for development</h3>

<p>you can also run a PostgreSQL instance with Docker:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">--name</span> postgres <span class="nt">-e</span> <span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>pgpassword <span class="nt">-d</span> <span class="nt">-p</span> 5432:5432 postgres
</code></pre></div></div>

<p>Then connect to it from another container on the same network:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">-it</span> <span class="nt">--rm</span> <span class="nt">--network</span> host postgres psql <span class="nt">-h</span> localhost <span class="nt">-U</span> postgres
</code></pre></div></div>

<p>You can create a database just for the <code class="language-plaintext highlighter-rouge">guestbook</code> application and grant all permissions to a new user specific for the <code class="language-plaintext highlighter-rouge">guestbook</code> application.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>postgres=# create database guestbook;
postgres=# create user guestbookuser with encrypted password 'guestbookpass';
postgres=# grant all privileges on database guestbook to guestbookuser;
postgres=# \q
</code></pre></div></div>

<p>In order to tell our application where to access our database, you need to use the <code class="language-plaintext highlighter-rouge">DATABASE_URL</code> environment variable. In
our example from the previous section, we started a container running PostgreSQL, so you’ll set the environment variable
like this:</p>

<p>Using Bash:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export DATABASE_URL="jdbc:postgresql://localhost:5432/guestbook?user=guestbookuser&amp;password=guestbookpass"
</code></pre></div></div>

<p>Using PowerShell:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$env:DATABASE_URL="jdbc:postgresql://localhost:5432/guestbook?user=guestbookuser&amp;password=guestbookpass"
</code></pre></div></div>

<p>Now, let’s make sure the database’s tables are using the most recent definition by running the following command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lein run migrate
</code></pre></div></div>

<p>This will apply any changes to the database definition that could be pending, such as creating or modifying tables.</p>

<p>You can use the <code class="language-plaintext highlighter-rouge">psql</code> utility to confirm the tables were created:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run -it --rm --network host postgres psql -h localhost -d guestbook -U guestbookuser
Password for user guestbookuser:
psql (14.5 (Debian 14.5-1.pgdg110+1))
Type "help" for help.

guestbook=&gt; select * from guestbook;
 id | name | message | timestamp
----+------+---------+-----------
(0 rows)

guestbook=&gt; select * from schema_migrations;
       id       |         applied         |     description
----------------+-------------------------+---------------------
 20190317085139 | 2022-08-24 16:28:02.528 | add-guestbook-table
(1 row)

guestbook=&gt; \q
</code></pre></div></div>

<h3 id="launching-the-application">Launching the application</h3>

<p>In order to run the application locally, you’ll need to provide some configuration for your dev environment. Since each developer
could have a different setup, this file is generally not checked-in with the rest of the source code. Copy the contents below
and save them in a file called <code class="language-plaintext highlighter-rouge">dev-config.edn</code> on the root of the project:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
 </span><span class="err">:dev</span><span class="w"> </span><span class="kc">true</span><span class="w">
 </span><span class="err">:port</span><span class="w"> </span><span class="mi">3000</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Finally, you can run the application locally with:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lein run
</code></pre></div></div>

<p>The server will start and after a while you should be able to access the application on http://localhost:3000/ and see
guestbook form. If you need to use another port, you can use the <code class="language-plaintext highlighter-rouge">PORT</code> environment variable or pass it as a parameter
in the command line as shown below:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lein run -p 8000
</code></pre></div></div>

<p>This is just the beginning. Clojure leans towards an interactive development style, so it’s enjoyed best when using
a live REPL console attached to the project. To learn more about it, see <a href="https://luminusweb.com/docs/repl.html">REPL Driven Development</a> in the Luminus framework docs.</p>

<h2 id="deployment-on-azure">Deployment on Azure</h2>

<h3 id="creating-cloud-resources">Creating cloud resources</h3>

<p>This step needs to be run only once to create the required resources in Azure.</p>

<p>If you haven’t logged in before, login into your Azure account with <code class="language-plaintext highlighter-rouge">az login</code> and follow the prompts.</p>

<p>The example application has a script, <a href="https://github.com/Azure-Samples/clojure-on-app-service/blob/main/create-resources.sh"><code class="language-plaintext highlighter-rouge">create-resources.sh</code></a>. The beginning of the file contains a configuration section where you can adjust some parameters such as the deployment region, and the database username and password. Set enviornment variables for the keys in the script to your desired values, or edit the script.</p>

<p>The script will create the following resources for you:</p>

<ul>
  <li>A resource group which will contain every other resource for this application</li>
  <li>A server to run a PostgreSQL instance</li>
  <li>A database in the PostgreSQL host</li>
  <li>A configuration entry to allow connections from services hosted in Azure to the database server</li>
  <li>An App Service Plan that can deploy Linux hosts</li>
  <li>A definition for the guestbook web application</li>
  <li>A configuration entry with the JDBC URL to connect from the guestbook web app to the database</li>
</ul>

<p>Run the script from Bash:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./create-resources.sh
</code></pre></div></div>

<p>Once all the resources are created correctly, it should print <code class="language-plaintext highlighter-rouge">All Azure resources created</code> in the console.</p>

<h3 id="configure-the-deployment">Configure the deployment</h3>

<p>Generate a Maven <code class="language-plaintext highlighter-rouge">pom.xml</code> file by running <code class="language-plaintext highlighter-rouge">lein pom</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>lein pom
Wrote .../guestbook/pom.xml
</code></pre></div></div>

<p>Run the following command line to use a Maven plugin which will detect and configure most of the parameters required for deployment:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvn com.microsoft.azure:azure-webapp-maven-plugin:2.5.0:config
</code></pre></div></div>

<p>The command above will prompt you to create a new Web App or to use an existing one. <strong>Choose the option to use the existing Web App</strong> that you created using the script in the previous step:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mvn com.microsoft.azure:azure-webapp-maven-plugin:2.5.0:config
<span class="o">[</span>INFO] Scanning <span class="k">for </span>projects...
...
<span class="o">[</span>INFO] Auth Type : AZURE_CLI, Auth Files : <span class="o">[</span>/home/user/.azure/azureProfile.json, /home/user/.azure/accessTokens.json]
...
<span class="o">[</span>INFO] It may take a few minutes to load all Java Web Apps, please be patient.
Java SE Web Apps <span class="k">in </span>subscription My Subscription:
<span class="k">*</span> 1: &lt;create&gt;
  2: guestbook-2048 <span class="o">(</span>linux, java 11-java11<span class="o">)</span>
Please choose a Java SE Web App <span class="o">[</span>&lt;create&gt;]: 2 &lt;<span class="o">==</span> CHOOSE TO USE EXISTING APP
Please confirm webapp properties
Subscription Id : <span class="o">(</span>...redacted...<span class="o">)</span>
AppName : guestbook-2048
ResourceGroup : guestbook-2048-rg
Region : westus2
PricingTier : Free_F1
OS : Linux
Java : Java 11
Web server stack: Java SE
Deploy to slot : <span class="nb">false
</span>Confirm <span class="o">(</span>Y/N<span class="o">)</span> <span class="o">[</span>Y]: Y &lt;<span class="o">==</span> CONFIRM THAT YOU WANT TO USE THE CURRENT SETTINGS
<span class="o">[</span>INFO] Saving configuration to pom.
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] BUILD SUCCESS
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] Total <span class="nb">time</span>:  19.405 s
<span class="o">[</span>INFO] Finished at: 2022-08-24T14:18:36-08:00
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
</code></pre></div></div>

<h3 id="update-the-pom-file">Update the POM file</h3>

<p>The file <code class="language-plaintext highlighter-rouge">pom.xml</code> generated by the <code class="language-plaintext highlighter-rouge">azure-webapp-maven-plugin</code> needs a minor tweak for deploying an Uberjar package.</p>

<p>You will need to edit the file <code class="language-plaintext highlighter-rouge">pom.xml</code> and replace the values in the following section:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;deployment&gt;</span>
    <span class="nt">&lt;resources&gt;</span>
      <span class="nt">&lt;resource&gt;</span>
        <span class="nt">&lt;directory&gt;</span>${project.basedir}/target/uberjar<span class="nt">&lt;/directory&gt;</span><span class="c">&lt;!-- new path --&gt;</span>
        <span class="nt">&lt;includes&gt;</span>
          <span class="nt">&lt;include&gt;</span>guestbook.jar<span class="nt">&lt;/include&gt;</span><span class="c">&lt;!-- single file --&gt;</span>
        <span class="nt">&lt;/includes&gt;</span>
      <span class="nt">&lt;/resource&gt;</span>
    <span class="nt">&lt;/resources&gt;</span>
  <span class="nt">&lt;/deployment&gt;</span>
</code></pre></div></div>

<p>You can perform the text replacements described above from the command line using <code class="language-plaintext highlighter-rouge">sed</code>, using the following commands:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/\/target/\/target\/uberjar/'</span> pom.xml

<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/\*\.jar/guestbook\.jar/'</span> pom.xml
</code></pre></div></div>

<p>Now, generate the JAR file to be deployed:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lein uberjar
</code></pre></div></div>

<p>The output will look like the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>lein uberjar
Compiling guestbook.config
Compiling guestbook.core
Compiling guestbook.db.core
Compiling guestbook.env
Compiling guestbook.handler
Compiling guestbook.layout
Compiling guestbook.middleware
Compiling guestbook.middleware.formats
Compiling guestbook.nrepl
Compiling guestbook.routes.home
Created /home/user/Projects/azure/guestbook/target/uberjar/guestbook-0.1.0-SNAPSHOT.jar
Created /home/user/Projects/azure/guestbook/target/uberjar/guestbook.jar
</code></pre></div></div>

<p>Finally, you can deploy your app to App Service:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mvn azure-webapp:deploy
</code></pre></div></div>

<p>After a few seconds, it will show the deployment status and the URL of the application</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>mvn azure-webapp:deploy
<span class="o">[</span>INFO] Scanning <span class="k">for </span>projects...
<span class="o">[</span>INFO] 
<span class="o">[</span>INFO] <span class="nt">------------------------</span>&lt; guestbook:guestbook <span class="o">&gt;</span><span class="nt">-------------------------</span>
<span class="o">[</span>INFO] Building guestbook 0.1.0-SNAPSHOT
<span class="o">[</span>INFO] <span class="nt">--------------------------------</span><span class="o">[</span> jar <span class="o">]</span><span class="nt">---------------------------------</span>
<span class="o">[</span>INFO] 
<span class="o">[</span>INFO] <span class="nt">---</span> azure-webapp-maven-plugin:2.5.0:deploy <span class="o">(</span>default-cli<span class="o">)</span> @ guestbook <span class="nt">---</span>
...
<span class="o">[</span>INFO] Trying to deploy artifact to guestbook-2048...
<span class="o">[</span>INFO] Deploying <span class="o">(</span>/.../guestbook/target/uberjar/guestbook.jar<span class="o">)[</span>jar]  ...
<span class="o">[</span>INFO] Successfully deployed the artifact to https://guestbook-2048.azurewebsites.net
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] BUILD SUCCESS
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
<span class="o">[</span>INFO] Total <span class="nb">time</span>:  27.655 s
<span class="o">[</span>INFO] Finished at: 2022-08-24T23:49:22-07:00
<span class="o">[</span>INFO] <span class="nt">------------------------------------------------------------------------</span>
</code></pre></div></div>

<p>Give it a minute for the application to deploy and warm up. The first time you visit the application you may see an error 500 if the database migrations have not completed, but after refreshing the page it will work fine.</p>

<p>If you want to delete the application and all the related resources, go to your <a href="https://portal.azure.com/#blade/HubsExtension/BrowseResourceGroups">Resource Groups</a> in the Azure Portal, then select the appropriate <code class="language-plaintext highlighter-rouge">guestbook</code> resource group and delete it.</p>


        
      </section>

      <footer class="page__meta">
          <p class="page__date"><strong><a href="https://docs.microsoft.com/answers/topics/azure-webapps.html">Post questions</a> | <a href="https://feedback.azure.com/forums/169385-web-apps">Provide product feedback</a></strong></p>
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2022-08-24T00:00:00+00:00">August 24, 2022</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Clojure+on+App+Service%20https%3A%2F%2Fazure.github.io%2FAppService%2F2022%2F08%2F24%2FClojure-on-AppService.html" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fazure.github.io%2FAppService%2F2022%2F08%2F24%2FClojure-on-AppService.html" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fazure.github.io%2FAppService%2F2022%2F08%2F24%2FClojure-on-AppService.html" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/AppService/2022/08/18/Configure-Azure-Firewall-With-ASEv3.html" class="pagination--pager" title="Configure Azure Firewall with ASEv3
">Previous</a>
    
    
      <a href="/AppService/2022/09/15/Configure-automation-for-upgrade-preferences-in-App-Service-Environment.html" class="pagination--pager" title="Control and automate planned maintenance for App Service Environment v3
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/AppService/media/pages/new_app_service_logo_64.svg"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/AppService/2025/11/04/app-service-agent-framework-part-3.html" rel="permalink">Part 3: Client-Side Multi-Agent Orchestration on Azure App Service with Microsoft Agent Framework
</a>
      
    </h2>
    
      <p class="page__meta">
        
          <i class="far fa-clock" aria-hidden="true"></i> 




  12 minute read

        
        
          • By Jordan Selig
        
        • November 4, 2025
      </p>
    
    <p class="archive__item-excerpt" itemprop="description">In Part 2 of this series, I showed you how to build sophisticated multi-agent systems on Azure App Service using Azure AI Foundry Agents—server-side managed ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/AppService/media/pages/new_app_service_logo_64.svg"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/AppService/2025/10/31/app-service-agent-framework-part-2.html" rel="permalink">Part 2: Build Long-Running AI Agents on Azure App Service with Microsoft Agent Framework
</a>
      
    </h2>
    
      <p class="page__meta">
        
          <i class="far fa-clock" aria-hidden="true"></i> 




  9 minute read

        
        
          • By Jordan Selig
        
        • October 31, 2025
      </p>
    
    <p class="archive__item-excerpt" itemprop="description">Last week, I shared how to build long-running AI agents on Azure App Service with Microsoft Agent Framework. If you haven’t seen that post yet, I would recom...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/AppService/media/pages/new_app_service_logo_64.svg"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/AppService/2025/10/29/node24-available.html" rel="permalink">Node.js 24 is now available on Azure App Service for Linux
</a>
      
    </h2>
    
      <p class="page__meta">
        
          <i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

        
        
          • By Tulika Chaudharie
        
        • October 29, 2025
      </p>
    
    <p class="archive__item-excerpt" itemprop="description">Node.js 24 LTS is live on Azure App Service for Linux. You can create a new Node 24 app through the Azure portal, automate it with the Azure CLI, or roll it ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "/AppService/media/pages/new_app_service_logo_64.svg"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/AppService/2025/10/29/VSTS-tasks-for-sidecars.html" rel="permalink">Azure Pipeline samples: add sidecars to Azure App Service for Linux
</a>
      
    </h2>
    
      <p class="page__meta">
        
          <i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

        
        
          • By Tulika Chaudharie
        
        • October 29, 2025
      </p>
    
    <p class="archive__item-excerpt" itemprop="description">Sidecars on Azure App Service let you attach extra containers — logging, telemetry, lightweight APIs, caches, AI inference helpers — alongside your main app,...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form onsubmit="return googleCustomSearchExecute();" id="cse-search-box-form-id">
    <label class="sr-only" for="cse-search-input-box-id">
      Enter your search term...
    </label>
    <input type="search" id="cse-search-input-box-id" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results">
    <gcse:searchresults-only></gcse:searchresults-only>
  </div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        

<div class="page__footer-follow">
  
    <a class="page-microsoft" href="https://www.microsoft.com"><img src="/AppService/media/pages/Microsoft_logo.svg" alt=""></a>
  
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/AzAppService" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/Azure/AppService" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    <li><a href="/AppService/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 Azure App Service. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/AppService/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>


<script>
  (function () {
    var cx = '015057007851139702326:ob8gaepprli';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();

  function googleCustomSearchExecute() {
    var input = document.getElementById('cse-search-input-box-id');
    var element = google.search.cse.element.getElement('searchresults-only0');
    if (input.value == '') {
      element.clearAllResults();
    } else {
      element.execute(input.value);
    }
    return false;
  }

  
    $(document).ready(function () {
      $('input#cse-search-input-box-id').on('keyup', function () {
        googleCustomSearchExecute();
      });
    });
  
</script>




  <script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-112478220-2']);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>









  </body>
</html>
